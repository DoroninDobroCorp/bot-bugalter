# –ò–∑–º–µ–Ω–µ–Ω–∏—è –æ—Ç 30.09.2025

## üÜï –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è: –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Ç–æ–ø–∏–∫–æ–≤ –≤ ID Matches Bot

### –û–ø–∏—Å–∞–Ω–∏–µ
–î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –≤–µ—Ç–∫–∏/—Ç–æ–ø–∏–∫–∏ –≤ Telegram, –≥–¥–µ –±–æ—Ç –Ω–µ –¥–æ–ª–∂–µ–Ω –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥—ã.

### –ù–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã
- **`/block_topic`** - –±–ª–æ–∫–∏—Ä—É–µ—Ç —Ç–µ–∫—É—â—É—é –≤–µ—Ç–∫—É (–±–æ—Ç –Ω–µ —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ —Ñ–æ—Ç–æ/"–ª–∞–π–≤"/"–ø—Ä–µ–º–∞—Ç—á")
- **`/unblock_topic`** - —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–µ—Ç —Ç–µ–∫—É—â—É—é –≤–µ—Ç–∫—É
- **`/show_ids_config`** - —Ç–µ–ø–µ—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≤–µ—Ç–æ–∫

### –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
1. –ó–∞–π–¥–∏—Ç–µ –≤ –≤–µ—Ç–∫—É "–û—Ç—á–µ—Ç—ã" (–∏–ª–∏ –¥—Ä—É–≥—É—é, –≥–¥–µ –Ω–µ –Ω—É–∂–Ω—ã –∫–æ–¥—ã)
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/block_topic`
3. –ì–æ—Ç–æ–≤–æ! –í —ç—Ç–æ–π –≤–µ—Ç–∫–µ –±–æ—Ç –±–æ–ª—å—à–µ –Ω–µ –±—É–¥–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥—ã

### –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã
- `id-matches-bot/main.py` - –¥–æ–±–∞–≤–ª–µ–Ω—ã –∫–æ–º–∞–Ω–¥—ã –∏ –ª–æ–≥–∏–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
- `id-matches-bot/COMMANDS.md` - –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- `id-matches-bot/BLOCK_TOPIC_GUIDE.md` - —Å–æ–∑–¥–∞–Ω–∞ –∫—Ä–∞—Ç–∫–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

### –ù–æ–≤—ã–π —Ñ–∞–π–ª
- `blocked_topics.json` - —Ö—Ä–∞–Ω–∏—Ç —Å–ø–∏—Å–æ–∫ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≤–µ—Ç–æ–∫ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —á–∞—Ç–∞

---

# –ò–∑–º–µ–Ω–µ–Ω–∏—è –æ—Ç 30.09.2025

## 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ —É–¥–∞–ª–µ–Ω–∏–µ –æ—Ç—á–µ—Ç–æ–≤

### –ü—Ä–æ–±–ª–µ–º–∞
–û—Ç—á–µ—Ç—ã —É–¥–∞–ª—è–ª–∏—Å—å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ - —Ñ–ª–∞–≥ `is_deleted` —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª—Å—è, –Ω–æ –∑–∞–ø–∏—Å–∏ –≤ `report_employee` –æ—Å—Ç–∞–≤–∞–ª–∏—Å—å, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ –¥—É–±–ª—è–º –∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º —Ä–∞—Å—á–µ—Ç–∞–º.

### –†–µ—à–µ–Ω–∏–µ
- –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `deleted_at` –≤ —Ç–∞–±–ª–∏—Ü—É `report` –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –¥–∞—Ç—ã —É–¥–∞–ª–µ–Ω–∏—è
- –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Ç–µ–ø–µ—Ä—å —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Ñ–ª–∞–≥ `is_deleted=True` –∏ —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è `deleted_at`
- –°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç `manager-bot/cleanup_deleted_reports.py` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—á–∏—Å—Ç–∫–∏ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –æ—Ç—á–µ—Ç–æ–≤ —Å—Ç–∞—Ä—à–µ 90 –¥–Ω–µ–π
- –°–∫—Ä–∏–ø—Ç —Ñ–∏–∑–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è–µ—Ç –∑–∞–ø–∏—Å–∏ –∏–∑ —Ç–∞–±–ª–∏—Ü `report` –∏ `report_employee`

### –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã
- `manager-bot/data/models.py` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ–ª–æ–Ω–∫–∞ `deleted_at`
- `flask_app/data/models.py` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ–ª–æ–Ω–∫–∞ `deleted_at`
- `auto-reports-bot/modules/models.py` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ–ª–æ–Ω–∫–∞ `deleted_at`
- `manager-bot/data/utils.py` - –æ–±–Ω–æ–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `delete_report_by_id()`
- `flask_app/app.py` - –æ–±–Ω–æ–≤–ª–µ–Ω –º–∞—Ä—à—Ä—É—Ç `/report/<id>/delete`
- `auto-reports-bot/modules/utils.py` - –æ–±–Ω–æ–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `delete_report()`

### –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã
- `manager-bot/cleanup_deleted_reports.py` - —Å–∫—Ä–∏–ø—Ç –æ—á–∏—Å—Ç–∫–∏ —Å—Ç–∞—Ä—ã—Ö —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –æ—Ç—á–µ—Ç–æ–≤
- `manager-bot/add_deleted_at_migration.py` - –º–∏–≥—Ä–∞—Ü–∏—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—è `deleted_at`

### –ó–∞–ø—É—Å–∫ –º–∏–≥—Ä–∞—Ü–∏–∏
```bash
cd /root/bot-bugalter/manager-bot
python3 add_deleted_at_migration.py
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∏ (cron)
–î–æ–±–∞–≤–∏—Ç—å –≤ crontab –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é:
```bash
0 3 * * 0 cd /root/bot-bugalter/manager-bot && python3 cleanup_deleted_reports.py >> /var/log/cleanup_reports.log 2>&1
```

---

## 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –æ—Ç—á–µ—Ç–æ–≤

### –ü—Ä–æ–±–ª–µ–º–∞
–ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ `/reports` –Ω–µ–ª—å–∑—è –±—ã–ª–æ –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç –≤–Ω—É—Ç—Ä–∏ –∫–∞—Ä—Ç–æ—á–µ–∫ –æ—Ç—á–µ—Ç–æ–≤.

### –†–µ—à–µ–Ω–∏–µ
- –ò–∑–º–µ–Ω–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞—Ä—Ç–æ—á–µ–∫: –≤–º–µ—Å—Ç–æ `<a>` –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ç–µ–ø–µ—Ä—å `<div>` —Å –≤–ª–æ–∂–µ–Ω–Ω—ã–º `<a>`
- –î–æ–±–∞–≤–ª–µ–Ω—ã inline-—Å—Ç–∏–ª–∏ `user-select: text` –¥–ª—è –≤—Å–µ—Ö —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- –ò–∑–º–µ–Ω–µ–Ω—ã –∫–ª–∞—Å—Å—ã –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –ø–µ—Ä–µ–Ω–æ—Å–∞ –¥–ª–∏–Ω–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤ (`break-words`)

### –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã
- `flask_app/templates/reports.html`

---

## 3. –î–æ–±–∞–≤–ª–µ–Ω –∫–æ–¥ –º–∞—Ç—á–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –æ—Ç—á–µ—Ç–æ–≤

### –û–ø–∏—Å–∞–Ω–∏–µ
–ü–æ–¥ –Ω–∞–∑–≤–∞–Ω–∏–µ–º –∫–∞–∂–¥–æ–≥–æ –º–∞—Ç—á–∞ —Ç–µ–ø–µ—Ä—å –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –µ–≥–æ –∫–æ–¥ (ID) –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –ø–æ–∏—Å–∫–∞.

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è
- –ö–æ–¥ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Å–µ—Ä—ã–º –º–æ–Ω–æ—à–∏—Ä–∏–Ω–Ω—ã–º —à—Ä–∏—Ñ—Ç–æ–º
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ù–∞—Ö–æ–¥–∏—Ç—Å—è –º–µ–∂–¥—É –Ω–∞–∑–≤–∞–Ω–∏–µ–º –º–∞—Ç—á–∞ –∏ –±—É–∫–º–µ–∫–µ—Ä–æ–º

### –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã
- `flask_app/templates/reports.html`

---

## 4. –î–æ–±–∞–≤–ª–µ–Ω —Ñ–∏–ª—å—Ç—Ä –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫—É –≤ –¥–µ—Ç–∞–ª—è—Ö –º–∞—Ç—á–∞

### –û–ø–∏—Å–∞–Ω–∏–µ
–ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –¥–µ—Ç–∞–ª–µ–π –º–∞—Ç—á–∞ (`/match/<id>`) –¥–æ–±–∞–≤–ª–µ–Ω—ã:
- **–í—ã–ø–∞–¥–∞—é—â–∏–π —Ñ–∏–ª—å—Ç—Ä** –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫—É (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –æ—Ç—á–µ—Ç—ã –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞)
- **–ß–µ–∫–±–æ–∫—Å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏** (–≥—Ä—É–ø–ø–∏—Ä—É–µ—Ç –æ—Ç—á–µ—Ç—ã –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º)
- –û–±–∞ –∫–æ–Ω—Ç—Ä–æ–ª–∞ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- –†–∞–±–æ—Ç–∞—é—Ç –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (Alpine.js)

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏
- –§–∏–ª—å—Ç—Ä—ã –∫–æ–º–ø–∞–∫—Ç–Ω—ã–µ –∏ –Ω–µ –∑–∞–≥—Ä–æ–º–æ–∂–¥–∞—é—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- –õ–µ–≥–∫–æ –æ—Ç–∫–ª—é—á–∞—é—Ç—Å—è (—Å–Ω—è—Ç—å –≥–∞–ª–æ—á–∫—É / –≤—ã–±—Ä–∞—Ç—å "–í—Å–µ")
- –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤

### –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã
- `flask_app/templates/match_detail.html`

---

## –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ–±—Ä–∞—Ç–Ω–æ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã. –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—é—Ç—Å—è, –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞ —Ç–æ–ª—å–∫–æ –º–∏–≥—Ä–∞—Ü–∏—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—è `deleted_at`.
